# =============================================================================
# SVAZ.APP ENVIRONMENT CONFIGURATION (EXTERNAL REVERSE PROXY MODE)
# =============================================================================
# Use this file when deploying behind Nginx Proxy Manager, Traefik, etc.
# Copy this file to .env and fill in your values
# =============================================================================

# -----------------------------------------------------------------------------
# DOMAIN CONFIGURATION
# -----------------------------------------------------------------------------
# Your domain name (e.g., svaz.app)
DOMAIN=svaz.app

# Email for SSL certificates (configured in your external reverse proxy)
SSL_EMAIL=admin@svaz.app

# External IP address (for TURN server NAT traversal)
# This will be auto-detected during installation
EXTERNAL_IP=0.0.0.0

# -----------------------------------------------------------------------------
# DATABASE (PostgreSQL)
# -----------------------------------------------------------------------------
POSTGRES_USER=svazapp
POSTGRES_PASSWORD=change_this_secure_password
POSTGRES_DB=svazapp
DATABASE_URL=postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@db:5432/${POSTGRES_DB}

# -----------------------------------------------------------------------------
# API SERVICE
# -----------------------------------------------------------------------------
# Node environment (development, production)
NODE_ENV=production

# API port (exposed to external proxy)
# Your reverse proxy will connect to this port
API_PORT=8080

# JWT secret for authentication (generate a strong random string)
JWT_SECRET=change_this_to_a_very_long_random_string_min_32_chars

# JWT expiration time (90 days for long-term sessions)
JWT_EXPIRES_IN=90d

# CORS origin (your domain with HTTPS)
CORS_ORIGIN=https://${DOMAIN}

# -----------------------------------------------------------------------------
# LIVEKIT (SFU Server)
# -----------------------------------------------------------------------------
# LiveKit API key (generate random string)
LIVEKIT_API_KEY=APIxxxxxxxxxxxxxxxx

# LiveKit API secret (generate random string)
LIVEKIT_API_SECRET=change_this_to_a_very_long_random_secret

# LiveKit server URL (internal docker network)
LIVEKIT_URL=ws://livekit:7880

# LiveKit public URL (accessible from frontend via your reverse proxy)
# Configure /livekit path in your reverse proxy to point to VPS_IP:7880
LIVEKIT_PUBLIC_URL=wss://${DOMAIN}/livekit

# -----------------------------------------------------------------------------
# COTURN (STUN/TURN Server)
# -----------------------------------------------------------------------------
# CoTURN realm
COTURN_REALM=${DOMAIN}

# CoTURN username
COTURN_USER=svazuser

# CoTURN password (generate strong password)
COTURN_PASSWORD=change_this_secure_coturn_password

# CoTURN listening port (must be forwarded directly from router to VPS)
COTURN_LISTENING_PORT=3478

# CoTURN TLS listening port (must be forwarded directly from router to VPS)
COTURN_TLS_LISTENING_PORT=5349

# CoTURN min/max port range for relay (must be forwarded directly from router to VPS)
COTURN_MIN_PORT=49152
COTURN_MAX_PORT=50151

# -----------------------------------------------------------------------------
# FRONTEND (Next.js PWA)
# -----------------------------------------------------------------------------
# Frontend port (exposed to external proxy)
# Your reverse proxy will connect to this port
FRONTEND_PORT=3000

# API URL for frontend (via your reverse proxy)
# Configure /api path in your reverse proxy to point to VPS_IP:8080
NEXT_PUBLIC_API_URL=https://${DOMAIN}/api

# Socket.io URL (via your reverse proxy)
NEXT_PUBLIC_SOCKET_URL=https://${DOMAIN}

# LiveKit URL for frontend (via your reverse proxy)
NEXT_PUBLIC_LIVEKIT_URL=wss://${DOMAIN}/livekit

# STUN/TURN servers (direct connection, NOT via reverse proxy)
NEXT_PUBLIC_STUN_URL=stun:${DOMAIN}:3478
NEXT_PUBLIC_TURN_URL=turn:${DOMAIN}:3478
NEXT_PUBLIC_TURNS_URL=turns:${DOMAIN}:5349

# WebTorrent trackers (public trackers for P2P)
NEXT_PUBLIC_WEBTORRENT_TRACKERS=wss://tracker.openwebtorrent.com,wss://tracker.btorrent.xyz

# -----------------------------------------------------------------------------
# SECURITY
# -----------------------------------------------------------------------------
# Rate limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW=15m

# Session secret
SESSION_SECRET=change_this_to_another_very_long_random_string

# -----------------------------------------------------------------------------
# LOGGING
# -----------------------------------------------------------------------------
LOG_LEVEL=info

